' Gambas class file

Public Sub Form_Resize()

    With pnlWeb
        .W = Me.ClientW - MMain.MARGIN * 2
        .H = Me.ClientH - MMain.MARGIN * 2
        .Left = MMain.MARGIN
        .Top = MMain.MARGIN
    End With

    pnlButtons.Left = MMain.MARGIN

    pnlUrl.W = pnlWeb.W - pnlButtons.W - MMain.MARGIN * 4
    pnlUrl.Left = pnlButtons.W + MMain.MARGIN * 3

    txbUrl.W = pnlUrl.W - spnStatus.W - MMain.MARGIN * 3
    txbUrl.Left = MMain.MARGIN

    spnStatus.Left = txbUrl.W + MMain.MARGIN * 2

    With wwwHelp
        .W = pnlWeb.W - MMain.MARGIN * 2
        .H = pnlWeb.H - txbUrl.H - MMain.MARGIN * 3
        .Left = MMain.MARGIN
        .Top = txbUrl.H + MMain.MARGIN * 2
    End With

End

Public Sub tlbBackward_Click()

    wwwHelp.Back()

End

Public Sub tlbForward_Click()

    wwwHelp.Forward()

End

Public Sub tlbRefresh_Click()

    wwwHelp.Reload()

End

Public Sub wwwHelp_Progress()

    spnStatus.Visible = True
    txbUrl.Text = wwwHelp.Url

End

Public Sub wwwHelp_Load()

    spnStatus.Visible = False

End

Public Sub tlbHome_Click()

    wwwHelp.Url = "file://" & Application.Path &/ MMain.HELPFILE

End

Public Sub Form_KeyPress()

    Select Case Key.Code
        Case Key.Left
            tlbBackward_Click()
        Case Key.Right
            tlbForward_Click()
        Case Key.Home
            tlbHome_Click()
        Case Key.F5
            tlbRefresh_Click()
    End Select

End