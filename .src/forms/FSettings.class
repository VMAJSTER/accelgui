' Gambas class file

Private intX As Integer
Private intY As Integer

Public Sub btnExit_Click()

    Me.Close()

End

Public Sub pctClose_MouseDown()

    btnExit_Click()

End

Public Sub pnlTitle_MouseDown()

    intX = Mouse.X + pnlTitle.Left
    intY = Mouse.Y + pnlTitle.Top

End

Public Sub pnlTitle_MouseMove()

    Dim intLeft As Integer
    Dim intTop As Integer

    If Mouse.Left Then
        intLeft = Mouse.ScreenX - intX
        intTop = Mouse.ScreenY - intY
        If intLeft >= 0 And intTop >= 0 Then
            If intLeft + Me.W <= Screen.W Then
                If intTop + Me.H <= Screen.H Then
                    Me.Left = intLeft
                    Me.Top = intTop
                Endif
            Endif
        Endif
    Endif

End

Public Sub lblTitle_MouseDown()

    pnlTitle_MouseDown()

End

Public Sub lblTitle_MouseMove()

    pnlTitle_MouseMove()

End


Public Sub btnReset_Click()

    txbAdmin.Text = "admin"
    txbUser.Text = "user"
    txbGuest.Text = "guest"
    rdbAdmin.Value = True

End

Public Sub btnSave_Click()

    Dim objControl As Control
    Dim objRadio As RadioButton

    If Trim(txbAdmin.Text) <> "" Then
        MMain.objSettings["Auth/admin"] = Crypt.SHA512(txbAdmin.Text, MMain.PREFIX)
    Endif
    If Trim(txbUser.Text) <> "" Then
        MMain.objSettings["Auth/user"] = Crypt.SHA512(txbUser.Text, MMain.PREFIX)
    Endif
    If Trim(txbGuest.Text) <> "" Then
        MMain.objSettings["Auth/guest"] = Crypt.SHA512(txbGuest.Text, MMain.PREFIX)
    Endif
    For Each objControl In Me.Controls
        If objControl Is RadioButton Then
            objRadio = objControl
            If objRadio.Value Then
                MMain.objSettings["Auth/default"] = objRadio.Tag
            Else
                MMain.objSettings["Auth/default"] = "0"
            Endif
        Endif
    Next
    Me.Close()

End
